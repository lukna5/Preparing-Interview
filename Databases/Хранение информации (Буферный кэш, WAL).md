__–ù–∞ –æ—Å–Ω–æ–≤–µ PostgreSQL__ 
# –ë—É—Ñ–µ—Ä–Ω—ã–π –∫—ç—à

## –ò–¥–µ—è
__PostgreSQL —Ö—Ä–∞–Ω–∏—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –¥–∏—Å–∫–µ –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤, —Ä–∞–∑–±–∏—Ç—ã—Ö –Ω–∞ –±–ª–æ–∫–∏ –ø–æ 8 –ö–ë:__

**–ë—É—Ñ–µ—Ä–Ω—ã–π –∫—ç—à** ‚Äî —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, –Ω–∞–∑—ã–≤–∞–µ–º–∞—è **`shared_buffers`**, –≤ –∫–æ—Ç–æ—Ä–æ–π PostgreSQL **—Ö—Ä–∞–Ω–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å–æ–≤**, —á—Ç–æ–±—ã **–º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –¥–∏—Å–∫—É**. –ö–∞–∂–¥—ã–π –±—É—Ñ–µ—Ä ‚Äî —ç—Ç–æ –º–µ—Å—Ç–æ –ø–æ–¥ –æ–¥–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö (–±–ª–æ–∫), –ø–ª—é—Å –∑–∞–≥–æ–ª–æ–≤–æ–∫.
–ó–∞–≥–æ–ª–æ–≤–æ–∫, –≤ —á–∏—Å–ª–µ –ø—Ä–æ—á–µ–≥–æ, —Å–æ–¥–µ—Ä–∂–∏—Ç: 
- —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–∞—Ö–æ–¥—è—â–µ–π—Å—è –≤ –±—É—Ñ–µ—Ä–µ (—Ñ–∞–π–ª –∏ –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞ –≤ –Ω–µ–º);
- –ø—Ä–∏–∑–Ω–∞–∫ —Ç–æ–≥–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –∏ —Ä–∞–Ω–æ –∏–ª–∏ –ø–æ–∑–¥–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –¥–∏—Å–∫ (—Ç–∞–∫–æ–π –±—É—Ñ–µ—Ä –Ω–∞–∑—ã–≤–∞—é—Ç¬†_–≥—Ä—è–∑–Ω—ã–º_);
- —á–∏—Å–ª–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –±—É—Ñ–µ—Ä—É (usage count);
- –ø—Ä–∏–∑–Ω–∞–∫ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ (pin count).

## –ü–æ–¥—Ä–æ–±–Ω–µ–µ
- –ö–æ–≥–¥–∞ PostgreSQL –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –æ–Ω —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏ –ø–æ–¥ `shared_buffers` (–∑–∞–¥–∞—ë—Ç—Å—è –≤ `postgresql.conf`). –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Å–º–µ—Ö–æ—Ç–≤–æ—Ä–Ω—ã–µ 128¬†–ú–±
- –ë—É—Ñ–µ—Ä/–ë–ª–æ–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **—Å—Ç—Ä–∞–Ω–∏—Ü** –ø–æ 8 –ö–ë. 
  –û–¥–∏–Ω –±–ª–æ–∫ = –∫—É—Å–æ–∫ —Ñ–∞–π–ª–∞ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞ —Ä–∞–∑–º–µ—Ä–æ–º 8 –ö–ë (–∫–æ—Ç–æ—Ä—ã–π –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è —Å –¥–∏—Å–∫–∞). __–¢–æ –µ—Å—Ç—å –∏–¥–µ–π–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—Ö–æ–¥–∏—Ç—å –≤ –±–ª–æ–∫ –ø–æ —Å—Å—ã–ª–∫–µ, —Ç–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ø—ã—Ç–∞–µ–º—Å—è —Å—Ö–æ–¥–∏—Ç—å –≤ –∫—ç—à, –∞ –ø–æ—Ç–æ–º –≤ –±–¥__.
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã–π –±–ª–æ–∫ —É–∂–µ –≤ –±—É—Ñ–µ—Ä–µ ‚Äî —á–∏—Ç–∞–µ–º –∏–∑ RAM (–±—ã—Å—Ç—Ä–æ).
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —á–∏—Ç–∞–µ–º —Å –¥–∏—Å–∫–∞ –∏ –∫–ª–∞–¥—ë–º –≤ –∫—ç—à.
- –ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å—É —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É, –æ–Ω —Å–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –µ–µ –≤ –±—É—Ñ–µ—Ä–Ω–æ–º –∫–µ—à–µ —Å –ø–æ–º–æ—â—å—é —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ã. –ö–ª—é—á–æ–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª—É–∂–∏—Ç __–Ω–æ–º–µ—Ä —Ñ–∞–π–ª–∞ –∏ –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã__ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞.
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ (–±–ª–æ–∫) –≤—Å–µ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º –≤ –±–¥** ‚Äî –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ
- –ö–æ–≥–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `shared_buffers` –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è, –æ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **dirty**.

## –ó–∞—á–µ–º
–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –∏–º–µ–µ—Ç –¥–µ–ª–æ –°–£–ë–î, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ (–∏–ª–∏ –Ω–∞ –¥—Ä—É–≥–æ–π —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –Ω–æ—Å–∏—Ç–µ–ª—å) –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º. –ß–µ–º —Ä–µ–∂–µ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, —Ç–µ–º –º–µ–Ω—å—à–µ –≤–≤–æ–¥-–≤—ã–≤–æ–¥ –∏ —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞.

## –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –æ–±—â–µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã. –ü–æ—Å–∫–æ–ª—å–∫—É –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É, –∏–º –Ω–µ—á–µ–≥–æ –¥–µ–ª–∞—Ç—å –≤ –æ–±—â–µ–º –±—É—Ñ–µ—Ä–Ω–æ–º –∫–µ—à–µ. –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–µ—à –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ —Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–ª–∞–¥–µ–µ—Ç —Ç–∞–±–ª–∏—Ü–µ–π. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—â–µ–≥–æ –±—É—Ñ–µ—Ä–Ω–æ–≥–æ –∫–µ—à–∞, –ø–∞–º—è—Ç—å –ø–æ–¥ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–µ—à –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

# WAL - Write-Ahead Logging (–ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
## –ò–¥–µ—è
**WAL (Write-Ahead Log)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º **–≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–Ω–∞—á–∞–ª–∞ –ø–∏—à—É—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∂—É—Ä–Ω–∞–ª (–ª–æ–≥)**, –∏ **—Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º** ‚Äî –≤ —Å–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –¥–∏—Å–∫–µ.
–ó–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å:

–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:  
üîí **"–°–Ω–∞—á–∞–ª–∞ –≤ –∂—É—Ä–Ω–∞–ª, –ø–æ—Ç–æ–º –≤ —Ç–∞–±–ª–∏—Ü—ã"** ‚Äî —á—Ç–æ–±—ã –ø—Ä–∏ —Å–±–æ–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î.
## –ó–∞—á–µ–º
- üß® **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è (crash recovery)**  
    –ï—Å–ª–∏ –ë–î –ø–∞–¥–∞–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–∫–ª—é—á–∏–ª–æ—Å—å –ø–∏—Ç–∞–Ω–∏–µ), –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏–∑ WAL.
- üîÅ **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è**  
    WAL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ (streaming replication). –°–ª–µ–π–≤-—Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç WAL-–∑–∞–ø–∏—Å–∏ –æ—Ç –º–∞—Å—Ç–µ—Ä–∞
- üßæ **–¢–æ—á–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (Point-In-Time Recovery)**  
    –ú–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î –¥–æ –ª—é–±–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ ‚Äî –∫–∞–∫ –≤ "–º–∞—à–∏–Ω–µ –≤—Ä–µ–º–µ–Ω–∏".
- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**  
    PostgreSQL –º–æ–∂–µ—Ç **–Ω–µ —Å—Ä–∞–∑—É –ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—ã**, –ø–æ—Ç–æ–º—É —á—Ç–æ WAL —É–∂–µ –Ω–∞–¥—ë–∂–Ω–æ –∑–∞–ø–∏—Å–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è.
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞
–ù–∞ –¥–∏—Å–∫–µ –∂—É—Ä–Ω–∞–ª —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ $PGDATA/pg_wal. –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–Ω–∏–º–∞–µ—Ç 16¬†–ú–±.

### –ó–∞–≥–æ–ª–æ–≤–æ–∫:
    - `LSN` ‚Äî –ø–æ–∑–∏—Ü–∏—è –∑–∞–ø–∏—Å–∏ –≤ –∂—É—Ä–Ω–∞–ª–µ
    - `XID` ‚Äî ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    - –¢–∏–ø (`INSERT`, `UPDATE`, `COMMIT`, ...)
    - –î–ª–∏–Ω–∞
    - CRC (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞)
### –î–∞–Ω–Ω—ã–µ (payload) ‚Äî –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏:
    - –¢–∞–±–ª–∏—Ü–∞, –±–ª–æ–∫, —Å–º–µ—â–µ–Ω–∏–µ
    - –ù–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏
    - –ü—Ä–∏ `UPDATE` ‚Äî —Å—Ç–∞—Ä–∞—è –∏ –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
    - –ü—Ä–∏ `COMMIT` ‚Äî —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –≤—Ä–µ–º—è
### Full page image (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
    - –ü–æ–ª–Ω–∞—è –∫–æ–ø–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã (8 –ö–ë)
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ `full_page_writes = on`

## –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã –ø–æ—à–∞–≥–æ–≤–æ
1. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–æ—Å—è—Ç—Å—è –≤ –ø–∞–º—è—Ç—å
	- –õ—é–±–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (`INSERT`, `UPDATE`, `DELETE`) –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç **—Å—Ç—Ä–∞–Ω–∏—Ü—ã (–±–ª–æ–∫–∏)** –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (`shared_buffers`).
	- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–π `PageLSN` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–∑–∏—Ü–∏–∏ –≤ WAL, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç—Ç–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—é.
  2. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è WAL-–∑–∞–ø–∏—Å—å
	  -  –°–æ–∑–¥–∞—ë—Ç—Å—è –±–∏–Ω–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è —Å—É—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏: —Ç–∞–±–ª–∏—Ü–∞, –±–ª–æ–∫, —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –ø–æ–∑–∏—Ü–∏—è (LSN).
	  - –≠—Ç–∞ –∑–∞–ø–∏—Å—å –ø–æ–ø–∞–¥–∞–µ—Ç –≤ **WAL-–±—É—Ñ–µ—Ä** ‚Äî –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏, –≤—Ä–µ–º–µ–Ω–Ω–æ —Ö—Ä–∞–Ω—è—â–∞—è –ª–æ–≥.
 3. COMMIT ‚Üí –∑–∞–ø–∏—Å—å WAL –Ω–∞ –¥–∏—Å–∫
	- –ü—Ä–∏ `COMMIT` WAL-–∑–∞–ø–∏—Å–∏ **fsync‚Äô—è—Ç—Å—è –Ω–∞ –¥–∏—Å–∫** (–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å).
	- –°–æ–∑–¥–∞—ë—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å `COMMIT` –≤ WAL.
	- –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π.
4. –ó–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è
	- –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É.
	- Dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ `shared_buffers` —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫:
	    - –ø—Ä–∏ **checkpoint‚Äô–µ**
	    - –ø—Ä–∏ **–≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–∏ –∏–∑ –∫—ç—à–∞**
	- **PostgreSQL –ù–ï –ò–ú–ï–ï–¢ –ü–†–ê–í–û** –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (–±–ª–æ–∫) —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –¥–∏—Å–∫, **–µ—Å–ª–∏ –µ—ë –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ—â—ë –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ WAL.**
	  –ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é PostgreSQL —Å–≤–µ—Ä—è–µ—Ç: `PageLSN` (–≤ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `shared_buffers`) ‚â§ `flushed WAL LSN` (–≠—Ç–æ **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π LSN**, –¥–æ –∫–æ—Ç–æ—Ä–æ–≥–æ **WAL –∑–∞–ø–∏—Å–∞–Ω –Ω–∞ –¥–∏—Å–∫ –≤ –∂—É—Ä–Ω–∞–ª**).

## ### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è
–ö–æ–≥–¥–∞ –º—ã —Å—Ç–∞—Ä—Ç—É–µ–º —Å–µ—Ä–≤–µ—Ä, –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å __postmaster__, –∞ –æ–Ω, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å __startup__, –∑–∞–¥–∞—á–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–µ–ª —Å–±–æ–π.

- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ë–î PostgreSQL –Ω–∞—Ö–æ–¥–∏—Ç **–ø–æ—Å–ª–µ–¥–Ω–∏–π checkpoint**.
- –ß–∏—Ç–∞–µ—Ç WAL —Å —ç—Ç–æ–π —Ç–æ—á–∫–∏.
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å WAL:
    - –µ—Å–ª–∏ –µ—Å—Ç—å COMMIT ‚Üí –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è (–∫–∞–∫ –æ–±—ã—á–Ω–æ —á–µ—Ä–µ–∑ –∫—ç—à)
    - –µ—Å–ª–∏ COMMIT –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

# –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ (Checkpoint)

## –ò–¥–µ—è
**Checkpoint (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞)** ‚Äî —ç—Ç–æ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ PostgreSQL **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –±–ª–æ–∫–∏) –∏–∑ shared_buffers –Ω–∞ –¥–∏—Å–∫**, –∏ **–ø–∏—à–µ—Ç –≤ –∂—É—Ä–Ω–∞–ª (WAL) —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –º–µ—Ç–∫—É**, —á—Ç–æ "–¥–æ —ç—Ç–æ–π —Ç–æ—á–∫–∏ –±–∞–∑–∞ —É–∂–µ —Ç–æ—á–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å WAL".
**`fsync`** ‚Äî —ç—Ç–æ **—Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã**, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –û–° **—Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ñ–∞–π–ª–æ–º, –∏–∑ –±—É—Ñ–µ—Ä–æ–≤ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫**.

**Dirty-—Å—Ç—Ä–∞–Ω–∏—Ü–∞** ‚Äî —ç—Ç–æ **—Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–±–ª–æ–∫) –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (`shared_buffers`)**, –∫–æ—Ç–æ—Ä–∞—è:
- üìç **–ë—ã–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `INSERT`, `UPDATE`, `DELETE`)
- ‚ùó **–ù–æ –µ—â—ë –Ω–µ –∑–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ –¥–∏—Å–∫** (–≤ heap-—Ç–∞–±–ª–∏—Ü—É)
- ‚úÖ **–ï—ë –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –µ—Å—Ç—å –≤ WAL** (–∏–Ω–∞—á–µ –Ω–µ–ª—å–∑—è)

![](assets/–•—Ä–∞–Ω–µ–Ω–∏–µ%20–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏%20(–ë—É—Ñ–µ—Ä–Ω—ã–π%20–∫—ç—à,%20WAL)/file-20250324212949722.png)
## –ó–∞—á–µ–º
### –ë–µ–∑ –Ω–µ–≥–æ:
- PostgreSQL –¥–æ–ª–∂–µ–Ω –±—ã–ª –±—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç—å **–≤–µ—Å—å WAL —Å –º–æ–º–µ–Ω—Ç–∞ —Å—Ç–∞—Ä—Ç–∞ –ë–î** –ø–æ—Å–ª–µ —Å–±–æ—è ‚Äî —ç—Ç–æ –¥–æ–ª–≥–æ –∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
### –° –Ω–∏–º:
- –ü—Ä–∏ –∫—Ä–∞—à–µ **–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ checkpoint**, –∞ –Ω–µ —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞ ‚Üí ‚ö° –±—ã—Å—Ç—Ä–æ
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç: –≤—Å—ë –¥–æ —ç—Ç–æ–π —Ç–æ—á–∫–∏ **–∑–∞–ø–∏—Å–∞–Ω–æ –Ω–∞ –¥–∏—Å–∫**
- - **–°–±—Ä–∞—Å—ã–≤–∞–µ—Ç dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ WAL –Ω–∞ –¥–∏—Å–∫ —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω**

## –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã –ø–æ—à–∞–≥–æ–≤–æ (—á—Ç–æ –¥–µ–ª–∞–µ—Ç PostgreSQL)
1. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑ –≤ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ (–Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å checkpointer) –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π 'checkpoint'.
2. –ò—â–µ—Ç –≤—Å–µ **dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—ã** (–∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –±–ª–æ–∫–∏ –≤ `shared_buffers`)
3. üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
    - `PageLSN ‚â§ flushed WAL LSN`
    - ‚úÖ –ó–Ω–∞—á–∏—Ç: –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–∂–µ **–µ—Å—Ç—å –≤ WAL**.
      –ò–Ω–∞—á–µ –±—ã –º–æ–≥–ª–æ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å, —á—Ç–æ –∑–∞–ø–∏—Å–∞–≤ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞, –ø–æ—Ç–µ—Ä—è–µ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å –∂—É—Ä–Ω–∞–ª–æ–º, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
4. üíæ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–∞–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã **–Ω–∞ –¥–∏—Å–∫ (–≤ heap-—Ñ–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü)**
5. ‚úçÔ∏è –í WAL —Å–æ–∑–¥–∞—ë—Ç—Å—è **—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å `CHECKPOINT`**
    - –°–æ–¥–µ—Ä–∂–∏—Ç:
        - LSN checkpoint-–∞
        - —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
        - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫—ç—à–∞
        - –ø–æ–∑–∏—Ü–∏–∏ redo
6. üßº –£–¥–∞–ª—è—é—Ç—Å—è (–∏–ª–∏ –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è) —Å—Ç–∞—Ä—ã–µ WAL-—Ñ–∞–π–ª—ã, —Ç.–∫. –≤—Å—ë –¥–æ —ç—Ç–æ–π —Ç–æ—á–∫–∏ —É–∂–µ –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö

## –§–æ–Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å

**–§–æ–Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å (background writing)** ‚Äî —ç—Ç–æ –≤–∞–∂–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –≤ PostgreSQL, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ **–º—è–≥–∫–∏–π, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Å–±—Ä–æ—Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö (dirty) —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (`shared_buffers`) –Ω–∞ –¥–∏—Å–∫**

### –ó–∞—á–µ–º
- –°–Ω–∏–∑–∏—Ç—å –ø–∏–∫–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤–æ –≤—Ä–µ–º—è checkpoint (—Ç–∞–∫ –∫–∞–∫ –∏–¥–µ—Ç —Å–±—Ä–æ—Å –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü —Ä–∞–∑–æ–º)
- –û—Å–≤–æ–±–æ–¥–∏—Ç—å –º–µ—Å—Ç–æ –≤ –±—É—Ñ–µ—Ä–µ
- –ü–æ–≤—ã—Å–∏—Ç—å –æ–±—â—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –≤—ã–≥—Ä—É–∂–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã

| –ö—Ä–∏—Ç–µ—Ä–∏–π              | –£—Å–ª–æ–≤–∏–µ                                      |
| --------------------- | -------------------------------------------- |
| Dirty?                | –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ (dirty)        |
| –ë–µ–∑–æ–ø–∞—Å–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏? | `PageLSN ‚â§ flushed WAL LSN`                  |
| –ù–µ –∑–∞–Ω—è—Ç–∞?            | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ–π—á–∞—Å –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |
| –ù–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è | –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ LRU —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º                   |
|                       |                                              |

### –û—Ç–ª–∏—á–∏—è
**Background writer** ‚Äî —ç—Ç–æ "—Ç–∏—Ö–∏–π –ø–æ–º–æ—â–Ω–∏–∫", –∫–æ—Ç–æ—Ä—ã–π **–ø–ª–∞–≤–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—ã**, —á—Ç–æ–±—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Ö –∫ checkpoint.
**Checkpoint** ‚Äî —ç—Ç–æ "–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –æ—Ç–º–µ—Ç–∫–∞", –∫–æ–≥–¥–∞ PostgreSQL –≥–æ–≤–æ—Ä–∏—Ç:  
"–î–æ —ç—Ç–æ–π —Ç–æ—á–∫–∏ –≤—Å—ë **—Ç–æ—á–Ω–æ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –Ω–∞ –¥–∏—Å–∫".


## –ü—Ä—è–º–∞—è –∑–∞–ø–∏—Å—å –≤ –±–¥
–û–±—ã—á–Ω–æ `fsync` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:
- –ø—Ä–∏ **COMMIT** ‚Äî –Ω–æ —ç—Ç–æ **fsync WAL**, –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ;
- –ø—Ä–∏ **checkpoint-–µ** ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç `checkpointer`;
- –ø—Ä–∏ —Ñ–æ–Ω–æ–≤–æ–º —Å–±—Ä–æ—Å–µ dirty-—Å—Ç—Ä–∞–Ω–∏—Ü ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç `bgwriter`

> **–ï—Å–ª–∏ –±—É—Ñ–µ—Ä–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã—Ç–µ—Å–Ω—è–µ—Ç—Å—è (–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–µ—Å—Ç–∞ –≤ shared_buffers), –∏ –µ—ë –Ω–∏–∫—Ç–æ –¥–æ —ç—Ç–æ–≥–æ –Ω–µ —Å–±—Ä–æ—Å–∏–ª, –∞ `PageLSN` ‚â§ flushed WAL LSN, —Ç–æ backend —Å–∞–º –¥–µ–ª–∞–µ—Ç `fsync`, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–∞–º—è—Ç—å.**

üìâ –≠—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è **–Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–µ–π**.

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ?

- Backend –ø—Ä–æ—Ü–µ—Å—Å "–æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞", –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ç—è–∂—ë–ª–æ–π –¥–∏—Å–∫–æ–≤–æ–π —Ä–∞–±–æ—Ç–æ–π.
- `fsync` ‚Äî –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –æ–Ω–∞ –º–æ–∂–µ—Ç –∑–∞–¥–µ—Ä–∂–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–∞.
- –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç **–≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞** –∏ **—Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**.

### –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π
1. –í `shared_buffers` **–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –º–µ—Å—Ç–æ**
2. Backend —Ö–æ—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—É—Ñ–µ—Ä, –Ω–æ –æ–Ω –∑–∞–Ω—è—Ç **dirty-—Å—Ç—Ä–∞–Ω–∏—Ü–µ–π**
3. Backend –æ–±—è–∑–∞–Ω –≤—ã—Ç–µ—Å–Ω–∏—Ç—å —ç—Ç–æ—Ç –±—É—Ñ–µ—Ä, –ù–û:
    - dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ "–≤—ã–±—Ä–æ—Å–∏—Ç—å"
    - –µ—ë –Ω—É–∂–Ω–æ **—Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –¥–∏—Å–∫**
4. Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
    - `PageLSN ‚â§ flushed WAL LSN`?
    - –°—Ç—Ä–∞–Ω–∏—Ü–∞ **–±–µ–∑–æ–ø–∞—Å–Ω–∞** –¥–ª—è —Å–±—Ä–æ—Å–∞?

### –ï—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω –≤ WAL
–ï—Å–ª–∏ backend **–¥–æ–ª–∂–µ–Ω –≤—ã—Ç–µ—Å–Ω–∏—Ç—å dirty-—Å—Ç—Ä–∞–Ω–∏—Ü—É** –∏–∑ `shared_buffers`, –Ω–æ:
- —É —Å—Ç—Ä–∞–Ω–∏—Ü—ã `PageLSN > flushed WAL LSN`,
- –∞ `checkpointer` –∏–ª–∏ `bgwriter` **–Ω–µ —É—Å–ø–µ–ª–∏** —Å–±—Ä–æ—Å–∏—Ç—å WAL.
üëâ —Ç–æ **backend –ø—Ä–æ—Å—Ç–æ –∂–¥—ë—Ç**, –ø–æ–∫–∞ WAL **–Ω–µ –±—É–¥–µ—Ç fsync‚Äô–Ω—É—Ç** –∏ –Ω–µ —Å—Ç–∞–Ω–µ—Ç **–±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É**.